<div class="analytics-container">
  <!-- Analytics Header -->
  <div class="analytics-header">
    <div class="header-content">
      <div class="header-text">
        <h1 class="analytics-title">
          <span class="material-icons title-icon">analytics</span>
          Data Analytics Dashboard
        </h1>
        <p class="analytics-subtitle">Comprehensive insights and trends across all council data sources</p>
      </div>
      
      <div class="header-actions">
        <button class="btn btn-secondary" (click)="refreshAnalytics()">
          <span class="material-icons">refresh</span>
          Refresh Data
        </button>
        <button class="btn btn-primary" (click)="exportReport()">
          <span class="material-icons">file_download</span>
          Export Report
        </button>
      </div>
    </div>
  </div>

  <!-- Analytics Content -->
  <div class="analytics-content">
    <div class="analytics-content-inner">
      
      <!-- Key Metrics Cards -->
      <div class="metrics-grid">
      <div class="metric-card total-records">
        <div class="metric-icon-wrapper">
          <span class="material-icons">database</span>
        </div>
        <div class="metric-content">
          <div class="metric-value">{{ totalRecords | number }}</div>
          <div class="metric-label">Total Records</div>
          <div class="metric-change positive">
            <span class="material-icons">trending_up</span>
            +12% from last month
          </div>
        </div>
      </div>
      
      <div class="metric-card active-councils">
        <div class="metric-icon-wrapper">
          <span class="material-icons">location_city</span>
        </div>
        <div class="metric-content">
          <div class="metric-value">{{ activeCouncils }}</div>
          <div class="metric-label">Active Councils</div>
          <div class="metric-change stable">
            <span class="material-icons">check_circle</span>
            All systems operational
          </div>
        </div>
      </div>
      
      <div class="metric-card data-quality">
        <div class="metric-icon-wrapper">
          <span class="material-icons">verified</span>
        </div>
        <div class="metric-content">
          <div class="metric-value">{{ dataQuality }}%</div>
          <div class="metric-label">Data Quality Score</div>
          <div class="metric-change positive">
            <span class="material-icons">trending_up</span>
            +3% improvement
          </div>
        </div>
      </div>
      
      <div class="metric-card last-update">
        <div class="metric-icon-wrapper">
          <span class="material-icons">schedule</span>
        </div>
        <div class="metric-content">
          <div class="metric-value">{{ lastUpdate | date:'HH:mm' }}</div>
          <div class="metric-label">Last Update</div>
          <div class="metric-change stable">
            <span class="material-icons">sync</span>
            {{ lastUpdate | date:'MMM dd, yyyy' }}
          </div>
        </div>
      </div>
    </div>

    <!-- Charts and Analytics Section -->
    <div class="charts-grid">
      
      <!-- Council Data Distribution -->
      <div class="chart-card">
        <div class="chart-header">
          <h3 class="chart-title">
            <span class="material-icons">pie_chart</span>
            Council Data Distribution
          </h3>
          <div class="chart-actions">
            <button class="chart-btn">
              <span class="material-icons">more_vert</span>
            </button>
          </div>
        </div>
        
        <div class="chart-content">
          <div class="council-stats-list">
            <div 
              class="council-stat-item" 
              *ngFor="let council of councilDataStats">
              <div class="council-info">
                <div class="council-name">{{ council.name }}</div>
                <div class="council-records">{{ council.records | number }} records</div>
              </div>
              <div class="council-progress">
                <div class="progress-bar">
                  <div 
                    class="progress-fill" 
                    [style.width.%]="council.percentage">
                  </div>
                </div>
                <div class="progress-percentage">{{ council.percentage }}%</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Monthly Trends -->
      <div class="chart-card">
        <div class="chart-header">
          <h3 class="chart-title">
            <span class="material-icons">show_chart</span>
            Monthly Data Trends
          </h3>
          <div class="chart-actions">
            <button class="chart-btn">
              <span class="material-icons">more_vert</span>
            </button>
          </div>
        </div>
        
        <div class="chart-content">
          <div class="trend-chart">
            <div class="chart-bars">
              <div 
                class="chart-bar" 
                *ngFor="let trend of monthlyTrends">
                <div 
                  class="bar-fill" 
                  [style.height.%]="(trend.records / 1300) * 100">
                </div>
                <div class="bar-label">{{ trend.month }}</div>
                <div class="bar-value">{{ trend.records | number }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Data Quality Metrics -->
      <div class="chart-card full-width">
        <div class="chart-header">
          <h3 class="chart-title">
            <span class="material-icons">assessment</span>
            Data Quality Metrics
          </h3>
          <div class="chart-actions">
            <button class="chart-btn">
              <span class="material-icons">more_vert</span>
            </button>
          </div>
        </div>
        
        <div class="chart-content">
          <div class="quality-metrics-grid">
            <div 
              class="quality-metric" 
              *ngFor="let metric of dataQualityMetrics">
              <div class="metric-header">
                <div class="metric-name">{{ metric.metric }}</div>
                <div class="metric-score" [attr.data-status]="getStatusColor(metric.value)">
                  {{ metric.value }}%
                </div>
              </div>
              
              <div class="metric-progress">
                <div class="progress-track">
                  <div 
                    class="progress-bar-fill" 
                    [style.width.%]="metric.value"
                    [attr.data-status]="getStatusColor(metric.value)">
                  </div>
                </div>
              </div>
              
              <div class="metric-status" [attr.data-status]="getStatusColor(metric.value)">
                <span class="material-icons">
                  {{ getStatusColor(metric.value) === 'success' ? 'check_circle' : 
                     getStatusColor(metric.value) === 'warning' ? 'warning' : 'error' }}
                </span>
                <span class="status-text">
                  {{ getStatusColor(metric.value) === 'success' ? 'Excellent' : 
                     getStatusColor(metric.value) === 'warning' ? 'Good' : 'Needs Attention' }}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
    </div>
  </div>
</div>
